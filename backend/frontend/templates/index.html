{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <link rel="stylesheet" href="{% static 'css/icons.css' %}" />
    <link
      href="{% static 'images/icon.png' %}"
      rel="shortcut icon"
      type="image/x-icon"
    />
    {{ settings_data|json_script:"settings-json" }}

    <script id="settings-json" type="application/json">
      {{ settings_data|json_script:"settings-json" }}
    </script>

    <script src="https://cdn.jsdelivr.net/clipboard.js/latest/clipboard.min.js"></script>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script src="{% static 'js/html2canvas.min.js' %}"></script>
    <script src="{% static 'js/script.js' %}?v=2.0.2"></script>

    <style>
      .overlays {
        position: fixed;
        inset: 0;
        display: flex;
        align-items: center;
        flex-direction: column;
        justify-content: center;
        z-index: 9999;
        background: #fff;
      }

      /* круговой индикатор загрузки */
      .progress-container {
        position: relative;
        width: 160px;
        height: 160px;
      }
      .loader-ring {
        width: 180px;
        height: 180px;
        border: 14px solid #eee;
        border-top: 14px solid #1d74f5;
        border-radius: 50%;
        animation: spin 1.6s linear infinite; /* медленнее */
        box-sizing: border-box;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      .progress-text {
        position: absolute;
top: 60%;
  left: 55%;
        transform: translate(-50%, -50%);
        text-align: center;
        font-size: 13px; /* уменьшил */
        color: #444;
        line-height: 1.3;
        width: 100%;
        
      }
      .progress-text .label {
        display: block;
        margin-bottom: 4px;
      }
      .progress-text .time {
        font-size: 12px;
        color: #666;
      }
      .jYGvkJaWLt {
        width: 300px;
        height: 100px;
        margin-bottom: 10px;
        background-image: url(../static/images/image.png);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        position: relative;
        top: -20px;
      }
      /* slider */
      .slider-wrap {
        text-align: center;
        position: relative;
        position: relative;
        height: 20vh;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        padding: 20px;
        box-sizing: border-box;
      }
      .track {
        width: 300px;
        height: 50px;
        background: linear-gradient(90deg, #003366, #005bb5);
        border-radius: 25px;
        position: relative;
        box-shadow: 0 0 20px 10px rgba(0, 51, 102, 0.5);
        overflow: hidden;
        transform: rotate(-13.1883deg);
       margin: 25.8041px 0px 0px -25.9713px;
      }
      .track::before {
        content: ">>>";
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        font-size: 36px;
        color: rgba(255, 255, 255, 0.3);
      }

      .handle {
        width: 50px;
        height: 50px;
        background: linear-gradient(90deg, #0073e6, #00aaff);
        border-radius: 50%;
        position: absolute;
        left: 0;
        top: 0;
        cursor: pointer;
        transition:
          left 0.3s,
          top 0.3s,
          box-shadow 0.3s;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 0 20px 10px rgba(0, 115, 230, 0.5);
      }
      .hint {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        pointer-events: none;
        color: #2b5ea6;
        font-weight: 600;
      }
      .display-row {
        display: flex;
        flex-direction: row;
      }
    </style>
    <title>
      случайное число.рф — простой удобный точный и понятный генератор случайных
      чисел
    </title>
    <style>
      .block {
        display: none;
      }
      .block.active {
        display: flex;
        align-content: center;
        align-items: center;
        justify-content: center;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div id="captchaBlock" class="block">{% include 'check_block.html' %}</div>

    <div id="contentBlock" class="block">{% include 'index_block.html' %}</div>

    <script>
      (function () {
        const captchaEl = document.getElementById("captchaBlock");
        const contentEl = document.getElementById("contentBlock");

        // проверка авторизации
        const authData = localStorage.getItem("userAuth");
        let verified = false;
        if (authData) {
          try {
            const parsed = JSON.parse(authData);
            if (parsed.expire > Date.now()) verified = true;
          } catch (e) {}
        }

        if (verified) {
          contentEl.classList.add("active");
        } else {
          captchaEl.classList.add("active");
        }

        // если в check_block есть кнопка / событие завершения капчи
        window.completeCaptcha = function () {
          const expire = Date.now() + 60 * 60 * 1000; // 1 час
          localStorage.setItem(
            "userAuth",
            JSON.stringify({ verified: true, expire }),
          );
          captchaEl.classList.remove("active");
          contentEl.classList.add("active");
        };
      })();
    </script>
  </body>
</html>
